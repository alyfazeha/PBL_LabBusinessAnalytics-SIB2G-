</html>

<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@100;300;400;500;700;900&display=swap"
    rel="stylesheet">

  <title>Business Analytics Laboratory</title>

  <link href="../vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
    integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
  <link rel="stylesheet" href="../assets/css/templatemo-chain-app-dev.css">
  <link rel="stylesheet" href="../assets/css/animated.css">
  <link rel="stylesheet" href="../assets/css/owl.css">

  <style>
    /* Tambahan CSS untuk Gallery */
    .gallery-item {
      overflow: hidden;
      border-radius: 8px;
      margin-bottom: 30px;
    }

    .gallery-item img {
      width: 100%;
      height: 250px;
      object-fit: cover;
      transition: transform 0.3s ease;
    }

    .gallery-item img:hover {
      transform: scale(1.05);
    }
  </style>

</head>

<body>
  <div id="js-preloader" class="js-preloader">
    <div class="preloader-inner">
      <span class="dot"></span>
      <div class="dots">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>
  </div>

  <header class="header-area header-sticky wow slideInDown" data-wow-duration="0.75s" data-wow-delay="0s">
    <div class="container">
      <div class="row">
        <div class="col-12">
          <nav class="main-nav">
            <a href="index.html" class="logo" style="margin-top: -7px;">
              <img src="../assets/images/LogoPolinema.png" alt="" style="width: 60px;">
              <img src="../assets/images/logoJTI.png" alt="" style="width: 50px;">
              <img src="../assets/images/LogoLab2.png" alt="Business Analytics Laboratory"
                style="width: 90px; margin-left: -15px;">
            </a>


            <ul class="nav">
              <li class="scroll-to-section"><a href="#top" class="active">Beranda</a></li>
              <li class="scroll-to-section"><a href="#gallery">Gallery</a></li>
              <li class="scroll-to-section"><a href="berita.html">Berita</a></li>
              <li class="scroll-to-section"><a href="jadwal-lab.html">Jadwal</a></li>
              <li class="scroll-to-section"><a href="panduan_peminjaman.html">Peminjaman</a></li>
              <li>
                <div class="gradient-button"><a id="" href="login.html"><i class="fa fa-sign-in-alt"></i>
                    Register | Login</a></div>
              </li>
            </ul>
            <a class='menu-trigger'>
              <span>Menu</span>
            </a>

          </nav>
        </div>
      </div>
    </div>
  </header>

  <div id="modal" class="popupContainer" style="display:none;">
    <div class="popupHeader">
      <span class="header_title">Login</span>
      <span class="modal_close"><i class="fa fa-times"></i></span>
    </div>

    <section class="popupBody">
      <div class="social_login">
        <div class="">
          <a href="#" class="social_box fb">
            <span class="icon"><i class="fab fa-facebook"></i></span>
            <span class="icon_title">Connect with Facebook</span>

          </a>

          <a href="#" class="social_box google">
            <span class="icon"><i class="fab fa-google-plus"></i></span>
            <span class="icon_title">Connect with Google</span>
          </a>
        </div>

        <div class="centeredText">
          <span>Or use your Email address</span>
        </div>

        <div class="action_btns">
          <div class="one_half"><a href="#" id="login_form" class="btn">Login</a></div>
          <div class="one_half last"><a href="#" id="register_form" class="btn">Sign up</a></div>
        </div>
      </div>

      <div class="user_login">
        <form>
          <label>Email / Username</label>
          <input type="text" />
          <br />

          <label>Password</label>
          <input type="password" />
          <br />

          <div class="checkbox">
            <input id="remember" type="checkbox" />
            <label for="remember">Remember me on this computer</label>
          </div>

          <div class="action_btns">
            <div class="one_half"><a href="#" class="btn back_btn"><i class="fa fa-angle-double-left"></i>
                Back</a>
            </div>
            <div class="one_half last"><a href="#" class="btn btn_red">Login</a></div>
          </div>
        </form>

        <a href="#" class="forgot_password">Forgot password?</a>
      </div>

      <div class="user_register">
        <form>
          <label>Full Name</label>
          <input type="text" />
          <br />

          <label>Email Address</label>
          <input type="email" />
          <br />

          <label>Password</label>
          <input type="password" />
          <br />

          <div class="checkbox">
            <input id="send_updates" type="checkbox" />
            <label for="send_updates">Send me occasional email updates</label>
          </div>

          <div class="action_btns">
            <div class="one_half"><a href="#" class="btn back_btn"><i class="fa fa-angle-double-left"></i>
                Back</a>
            </div>
            <div class="one_half last"><a href="#" class="btn btn_red">Register</a></div>
          </div>
        </form>
      </div>
    </section>
  </div>

  <div class="main-banner wow fadeIn" id="top" data-wow-duration="1s" data-wow-delay="0.5s">
    <div class="container">
      <div class="row">
        <div class="col-lg-12">
          <div class="row">
            <div class="col-lg-6 align-self-center">
              <div class="left-content show-up header-text wow fadeInLeft" data-wow-duration="1s" data-wow-delay="1s">
                <div class="row">
                  <div class="col-lg-12">
                    <h2 style="color: white;">Business Analytics Laboratory</h2>
                    <p style="color: white;">Laboratorium Analisa Bisnis adalah unit pendukung di
                      Jurusan Teknologi
                      Informasi yang fokus pada analisis sistem, manajemen data, dan pemodelan
                      bisnis. Laboratorium ini
                      mendukung kegiatan praktikum, penelitian, dan pengembangan solusi teknologi
                      informasi. Fungsi
                      utamanya meliputi analisis kebutuhan sistem, perancangan proses bisnis, dan
                      pendukung pengambilan
                      keputusan. Laboratorium ini juga menjadi wadah inovasi bagi dosen dan
                      mahasiswa dalam penelitian
                      berbasis data. Tujuannya adalah meningkatkan kualitas pembelajaran dan
                      menghasilkan lulusan yang
                      kompeten di bidang analisis serta perancangan bisnis.</p>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-lg-6">
              <div class="right-image wow fadeInRight" data-wow-duration="1s" data-wow-delay="0.5s">
                <img src="../assets/images/MaskotLabTransparant.png" alt="" style="margin-left: 100px;">
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div id="gallery" class="the-gallery">
    <div class="container">
      <div class="row">
        <div class="col-lg-8 offset-lg-2">
          <div class="section-heading" style="margin-bottom: 5px; margin-top: -50px;">
            <h4>Our Laboratory <em>Gallery</em> </h4>
            <img src="../assets/images/heading-line-dec.png" alt="">
          </div>
        </div>
        <div class="row">
          <div class="col-lg-4 col-md-6 wow fadeInUp" data-wow-duration="1s" data-wow-delay="0.2s">
            <div class="gallery-item">
              <img src="../assets/images/gallery1.jpg" alt="Lab View 1">
            </div>
          </div>
          <div class="col-lg-4 col-md-6 wow fadeInUp" data-wow-duration="1s" data-wow-delay="0.4s">
            <div class="gallery-item">
              <img src="../assets/images/gallery2.jpg" alt="Lab Activity 2">
            </div>
          </div>
          <div class="col-lg-4 col-md-6 wow fadeInUp" data-wow-duration="1s" data-wow-delay="0.6s">
            <div class="gallery-item">
              <img src="../assets/images/gallery3.jpg" alt="Lab Facility 3">
            </div>
          </div>
          <div class="col-lg-4 col-md-6 wow fadeInUp" data-wow-duration="1s" data-wow-delay="0.8s">
            <div class="gallery-item">
              <img src="../assets/images/gallery3.jpg" alt="Seminar 4">
            </div>
          </div>
          <div class="col-lg-4 col-md-6 wow fadeInUp" data-wow-duration="1s" data-wow-delay="1.0s">
            <div class="gallery-item">
              <img src="../assets/images/gallery1.jpg" alt="Workshop 5">
            </div>
          </div>
          <div class="col-lg-4 col-md-6 wow fadeInUp" data-wow-duration="1s" data-wow-delay="1.2s">
            <div class="gallery-item">
              <img src="../assets/images/gallery2.jpg" alt="Dosen Meeting 6">
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div id="vision-mission" class="vision-mission">
    <div class="container">
      <div class="row">
        <div class="col-lg-6 align-self-center" style="padding-right: 70px;">
          <div class="section-heading">
            <h4> <em>Vision of </em> Laboratory</h4>
            <img src="../assets/images/heading-line-dec.png" alt="">
          </div>
          <div class="row">
            <div class="box-item" style="height: 250px;">
              <h4 style="text-align: center; padding-top: 30px;">Menjadi laboratorium unggul rujukan
                nasional sebagai
                inkubator solusi cerdas berbasis
                data, yang berfungsi sebagai mitra strategis industri untuk mengakselerasi tranformasi
                bisnis dan
                pengambilan keputusan yang berdampak.</h4>
            </div>
          </div>
        </div>
        <div class="col-lg-6">
          <div class="section-heading">
            <h4> <em>Mission of </em>Laboratory</h4>
            <img src="../assets/images/heading-line-dec.png" alt="">
          </div>
          <div class="row">
            <div class="col-lg-6">
              <div class="box-item">
                <h4>Mengembangkan riset terapan</h4>
              </div>
            </div>
            <div class="col-lg-6">
              <div class="box-item">
                <h4>Mengintegrasikan berbagai disiplin ilmu</h4>
              </div>
            </div>
            <div class="col-lg-6">
              <div class="box-item">
                <h4>Membangun kemitraan strategis dengan industry</h4>
              </div>
            </div>
            <div class="col-lg-6">
              <div class="box-item">
                <h4>Mengembangkan talenta (dosen dan mahasiswa)</h4>
              </div>
            </div>
            <div class="">
              <div class="box-item">
                <h4>Menjalankan tata kelola laboratorium yang profesional, etis, dan berkelanjutan</h4>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div id="facilitys" class="facilitys section">
    <div class="container">
      <div class="row">
        <div class="col-lg-8 offset-lg-2">
          <div class="section-heading  wow fadeInDown" data-wow-duration="1s" data-wow-delay="0.5s">
            <h4>Fasilitas <em>& </em>Peralatan</h4>
            <img src="../assets/images/heading-line-dec.png" alt="">
          </div>
        </div>
      </div>
    </div>
    <div class="container">
      <div class="row">
        <div class="col-lg-3">
          <div class="facility-item ">
            <h4>Ruang Laboratorium</h4>
            <p>Ruang laboratorium dengan perangkat komputer dan perangkat lunak analisis bisnis, mendukung
              praktikum,
              eksperimen, dan penelitian.</p>
          </div>
        </div>
        <div class="col-lg-3">
          <div class="facility-item ">
            <h4>Tools Analisis</h4>
            <p>Akses berbagai tools pemodelan proses bisnis, analisis data, serta simulasi sistem informasi.
            </p>
          </div>
        </div>
        <div class="col-lg-3">
          <div class="facility-item ">
            <h4>Perangkat Presentasi & Diskusi</h4>
            <p>Dilengkapi perangkat presentasi interaktif dan sarana diskusi untuk kegiatan kolaboratif.</p>
          </div>
        </div>
        <div class="col-lg-3">
          <div class="facility-item ">
            <h4>Jaringan Internet & Server</h4>
            <p>Jaringan internet berkecepatan tinggi serta server lokal mendukung praktikum, riset, dan
              kolaborasi
              kampus.</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <section class="publications" id="publications">
    <div class="container">
      <div class="row">
        <div class="col-lg-12">
          <div class="section-heading">
            <h4>Sorotan <em>Publikasi</em></h4>
            <img src="../assets/images/heading-line-dec.png" alt="">
          </div>
        </div>
      </div>

      <div class="row filter-controls">
        <div class="col-lg-12">
          <div class="main-buttons d-flex flex-wrap gap-2">

            <div id="filterTahun" class="filter-dropdown">
              <button class="filter-btn dropdown-toggle" type="button" data-bs-toggle="dropdown">Tahun</button>
              <ul id="listTahun" class="dropdown-menu"></ul>
            </div>

            <div id="filterFokus" class="filter-dropdown">
              <button class="filter-btn dropdown-toggle" type="button" data-bs-toggle="dropdown">Fokus Riset</button>
              <ul id="listFokus" class="dropdown-menu"></ul>
            </div>

            <div id="filterKategori" class="filter-dropdown">
              <button class="filter-btn dropdown-toggle" type="button" data-bs-toggle="dropdown">Kategori</button>
              <ul id="listKategori" class="dropdown-menu"></ul>
            </div>

            <a href="URL_SINTA" target="_blank" class="main-blue-button sinta-button">Lihat Semua SINTA</a>
          </div>
        </div>
      </div>
      <div id="publicationsContainer" class="row publications-row">
        <div class="col-lg-12 text-center" id="pubLoadingMessage">
          <p class="loading-message"><i class="fa fa-spinner fa-spin"></i> Memuat data publikasi...</p>
        </div>
      </div>

      <div class="row navigation-controls">
        <div class="col-lg-12">
          <div id="paginationContainer" class="pagination-buttons">
          </div>
        </div>
      </div>
    </div>
  </section>



  <div id="proyeks" class="proyeks section">
    <div class="container">
      <div class="row">
        <div class="col-lg-8 offset-lg-2">
          <div class="section-heading  wow fadeInDown" data-wow-duration="1s" data-wow-delay="0.5s">
            <h4>Kegiatan <em>& </em>Proyek</h4>
            <img src="../assets/images/heading-line-dec.png" alt="">
          </div>
        </div>
      </div>
    </div>
    <div class="container">
      <div class="row">
        <div class="col">
          <div class="proyek-item ">
            <h4>Praktikum Mahasiswa</h4>
            <p>Praktikum mahasiswa terkait analisis kebutuhan sistem, pemodelan proses bisnis, dan
              dokumentasi sistem
              informasi.</p>
          </div>
        </div>
        <div class="col">
          <div class="proyek-item ">
            <h4>Penelitian</h4>
            <p>Penelitian dosen dan mahasiswa di bidang analisis bisnis, sistem informasi, dan manajemen
              data.</p>
          </div>
        </div>
        <div class="col">
          <div class="proyek-item ">
            <h4>Workshop & Seminar</h4>
            <p>Workshop, seminar, serta pelatihan internal untuk meningkatkan kompetensi analisis bisnis
              berbasis
              teknologi.</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div id="dosen-member" class="the-dosen-member">
    <div class="container">
      <div class="row">
        <div class="col-lg-8 offset-lg-2">
          <div class="section-heading" style="margin-bottom: 50px;">
            <h4>Anggota <em>Dosen</em> Laboratorium</h4>
            <img src="../assets/images/heading-line-dec.png" alt="">
          </div>
        </div>
      </div>

      <div class="container">
        <div class="dosen-scroll-container">
          <div class="dosen-list-wrapper" id="dosen-list-flex">
            <div id="loading-message" style="text-align: center; padding: 50px;">Memuat data dosen...</div>
          </div>
        </div>
      </div>
    </div>
  </div>


  <div id="services" class="services section">
    <div class="container">
      <div class="row">
        <div class="col-lg-8 offset-lg-2">
          <div class="section-heading  wow fadeInDown" data-wow-duration="1s" data-wow-delay="0.5s">
            <h4><em>Perkuliahan </em>Terkait</h4>
            <img src="../assets/images/heading-line-dec.png" alt="">
            <p>Mencakup kompetensi inti yang dibutuhkan untuk memahami, mengelola, dan mengembangkan proses
              bisnis
              modern secara efektif.</p>
          </div>
        </div>
      </div>
    </div>
    <div class="container">
      <div class="row">
        <div class="col-lg-3">
          <div class="service-item first-service">
            <div class="icon"></div>
            <h4>Analisa Proses Bisnis</h4>
            <p>Analisis, pemetaan, dan optimalisasi proses bisnis berbasis teknologi informasi</p>
          </div>
        </div>
        <div class="col-lg-3">
          <div class="service-item second-service">
            <div class="icon"></div>
            <h4>Business Intelligence</h4>
            <p>Pemanfaatan data warehouse, dashboard, dan visualisasi untuk mendukung pengambilan keputusan.
            </p>
          </div>
        </div>
        <div class="col-lg-3">
          <div class="service-item third-service">
            <div class="icon"></div>
            <h4>Data Mining</h4>
            <p>Teknik ekstraksi pola, klasifikasi, clustering, dan asosiasi dari data besar.</p>
          </div>
        </div>
        <div class="col-lg-3">
          <div class="service-item fourth-service">
            <div class="icon"></div>
            <h4>E-Business dan Startup Digital</h4>
            <p>Penerapan sistem digital untuk bisnis online dan model startup.</p>
          </div>
        </div>
      </div>
    </div>
    <div class="container" style="padding-top: 50px;">
      <div class="row">
        <div class="col-lg-3">
          <div class="service-item first-service">
            <div class="icon"></div>
            <h4>Kecerdasan Bisnis</h4>
            <p>Integrasi AI, analitik prediktif, dan machine learning dalam konteks bisnis.</p>
          </div>
        </div>
        <div class="col-lg-3">
          <div class="service-item second-service">
            <div class="icon"></div>
            <h4>Kewirausahaan Berbasis Teknologi</h4>
            <p>Pengembangan ide bisnis inovatif berbasis teknologi.</p>
          </div>
        </div>
        <div class="col-lg-3">
          <div class="service-item third-service">
            <div class="icon"></div>
            <h4>Manajemen Produk</h4>
            <p>Strategi perencanaan, pengembangan, dan siklus hidup produk digital.</p>
          </div>
        </div>
        <div class="col-lg-3">
          <div class="service-item fourth-service">
            <div class="icon"></div>
            <h4>Pemasaran Digital</h4>
            <p>Teknik promosi digital, social media marketing, dan strategi kampanye online.</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <footer id="newsletter">
    <div class="container">
      <div class="row">
        <div class="col-lg-8 offset-lg-2">
          <div class="section-heading" style="margin-top: -30px;">
            <h4>Get to Know Us</h4>
          </div>
        </div>
        <div class="col-lg-6 offset-lg-3">
          <form id="search" action="#" method="GET">
            <div class="row" style="margin-top: -30px; margin-bottom: -50px;">
              <fieldset>
                <button class="main-button"><a href="https://www.polinema.ac.id" style="color: #fff; "
                    target="_blank">Politeknik Negeri
                    Malang Official
                    Website</a></button>
              </fieldset>
            </div>
          </form>
        </div>
      </div>
      <div class="row">
        <div class="col" style="padding-right: 50px;">
          <div class="footer-widget">
            <h4>Tentang Lab Kami</h4>
            <div class="img">
              <img src="../assets/images/LogoPolinema.png" alt="Logo Polinema" style="width: 80px;">
              <img src="../assets/images/logoJTI.png" alt="Logo JTI" style="width: 70px;">
              <img src="../assets/images/LogoLab2.png" alt="Logo Lab" style="width: 110px; margin-left: -14px;">
            </div>
            <p>Laboratorium Jurusan Teknologi Informasi yang berfokus pada riset dan solusi teknologi
              informasi untuk
              mendukung dunia
              bisnis dan akademis.</p>
          </div>
        </div>
        <div class="col">
          <div class="footer-widget">
            <h4>Hubungi Kami</h4>
            <p>Jl. Soekarno Hatta No.9, Jatimulyo, Kec. Lowokwaru, Kota Malang, Jawa Timur 65141</p>

            <div class="social-links-footer">
              <a href="https://www.instagram.com/jtipolinema/" target="_blank" title="Kunjungi Instagram Lab">
                <i class="fab fa-instagram"></i>
              </a>
              <a href="https://www.youtube.com/@jtipolinema367" target="_blank" title="Tonton Video di YouTube Lab">
                <i class="fab fa-youtube"></i>
              </a>
            </div>
          </div>
        </div>

        <div class="col">
          <div class="footer-widget">
            <div class="map-container" style="margin-bottom: 20px; position: relative;">

              <a href="https://maps.google.com/?cid=8691078281011477154&g_mp=Cidnb29nbGUubWFwcy5wbGFjZXMudjEuUGxhY2VzLlNlYXJjaFRleHQ"
                target="_blank"
                style="display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 10;"
                title="Buka Google Maps Politeknik Negeri Malang">
              </a>

              <iframe
                src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3951.5026830854117!2d112.6161209!3d-7.946891200000002!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x2e78827687d272e7%3A0x789ce9a636cd3aa2!2sPoliteknik%20Negeri%20Malang!5e0!3m2!1sid!2sid!4v1765378894293!5m2!1sid!2sid"
                width="100%" height="250" style="border:0; border-radius: 8px; position: relative; z-index: 1;"
                allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"
                title="Peta Lokasi Politeknik Negeri Malang">
              </iframe>
            </div>
          </div>
        </div>

        <div class="col-lg-12" style="margin-top: -50px; margin-bottom: -50px;">
          <div class="copyright-text">
            <p>Copyright Â© 2025 Business Analytics Laboratory. All Rights Reserved.
            </p>
          </div>
        </div>
      </div>
    </div>
  </footer>


  <script src="../vendor/jquery/jquery.min.js"></script>
  <script src="../vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="../assets/js/owl-carousel.js"></script>
  <script src="../assets/js/animation.js"></script>
  <script src="../assets/js/imagesloaded.js"></script>
  <script src="../assets/js/popup.js"></script>
  <script src="../assets/js/custom.js"></script>
  <script src="../vendor/jquery/jquery.min.js"></script>
  <script src="../vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

  <script>
    // ==========================================================
    // 1. KONFIGURASI & VARIABEL GLOBAL
    // ==========================================================
    const PUB_API_URL = '../../backend/api/publikasi/list_public.php';
    const DOSEN_API_URL = '../../backend/api/dosen/list_public.php';
    const DEFAULT_FOTO = '../assets/images/dosen.jpg';

    let allPubData = [];
    let filteredPubData = [];
    let currentPage = 1;
    const limit = 3;

    // State Filter Aktif
    let activeFilters = {
      tahun: 'all',
      fokus: 'all',
      kategori: 'all'
    };

    // ==========================================================
    // 2. BAGIAN PUBLIKASI (FILTER & PAGINATION)
    // ==========================================================

    async function initPublikasi() {
      const container = document.getElementById('publicationsContainer');
      // Asumsi Anda punya elemen untuk loading, jika tidak, abaikan variabel ini
      const loading = document.getElementById('pubLoadingMessage');

      if (!container) return;
      if (loading) loading.style.display = 'block';

      try {
        const response = await fetch(PUB_API_URL);
        const res = await response.json();

        if (res.status === 'success' && Array.isArray(res.data)) {
          // Urutkan data berdasarkan tahun (terbaru dulu)
          allPubData = res.data.sort((a, b) => (b.tahun || 0) - (a.tahun || 0));
          filteredPubData = [...allPubData];

          if (loading) loading.style.display = 'none';

          renderFilterMenus();
          renderPublikasi(1); // Tampilkan halaman pertama
        } else {
          throw new Error(res.message || 'Data publikasi kosong atau tidak valid.');
        }
      } catch (err) {
        console.error("[Publikasi Error]:", err);
        // Ganti pesan loading dengan pesan error
        if (loading) loading.innerHTML = `<p class="text-danger text-center">Gagal memuat data publikasi. (${err.message})</p>`;
        // Kosongkan container jika ada error
        container.innerHTML = `<div class="col-12 text-center py-4"><p>Gagal memuat data publikasi.</p></div>`;
      }
    }

    // --- Filter Handlers ---

    function renderFilterMenus() {
      // Ambil data unik untuk filter
      const years = [...new Set(allPubData.map(d => String(d.tahun)))].filter(y => y !== "null" && y !== "" && y !== "0").sort((a, b) => b - a);
      const focus = [...new Set(allPubData.map(d => d.nama_fokus))].filter(Boolean).sort();
      const cats = [...new Set(allPubData.map(d => d.nama_kategori))].filter(Boolean).sort();

      fillDropdown('listTahun', 'filterTahun', years, 'Tahun');
      fillDropdown('listFokus', 'filterFokus', focus, 'Fokus Riset');
      fillDropdown('listKategori', 'filterKategori', cats, 'Kategori');
    }

    function fillDropdown(listId, containerId, items, label) {
      const listEl = document.getElementById(listId);
      const containerEl = document.getElementById(containerId);
      if (!listEl || !containerEl) return;

      const btnEl = containerEl.querySelector('.filter-btn');
      // Set label asli (jika belum ada)
      if (!btnEl.dataset.originalLabel) {
        btnEl.dataset.originalLabel = label;
      }

      const key = containerId.replace('filter', '').toLowerCase(); // 'tahun', 'fokus', 'kategori'

      // Buat opsi "Semua" aktif secara default
      let html = `<li><a class="dropdown-item active" href="#" data-value="all" data-filter-key="${key}">Semua ${label}</a></li>`;
      items.forEach(val => {
        html += `<li><a class="dropdown-item" href="#" data-value="${val}" data-filter-key="${key}">${val}</a></li>`;
      });
      listEl.innerHTML = html;
    }

    function applyFilters() {
      filteredPubData = allPubData.filter(item => {
        // Normalisasi data dari API menjadi string lowercase untuk perbandingan yang aman
        const itemYear = String(item.tahun || "").trim();
        const itemFocus = (item.nama_fokus || "").trim().toLowerCase();
        const itemCat = (item.nama_kategori || "").trim().toLowerCase();

        // Normalisasi nilai filter
        const filterYear = activeFilters.tahun;
        const filterFocus = activeFilters.fokus.trim().toLowerCase();
        const filterCat = activeFilters.kategori.trim().toLowerCase();

        // Logika filter: Jika 'all', selalu true. Jika ada nilai, harus sama.
        const matchYear = filterYear === 'all' || itemYear === filterYear;
        const matchFocus = filterFocus === 'all' || itemFocus === filterFocus;
        const matchCat = filterCat === 'all' || itemCat === filterCat;

        return matchYear && matchFocus && matchCat;
      });

      renderPublikasi(1); // Selalu reset ke halaman 1
    }

    // --- Render Functions (Pagination & Cards) ---

    function renderPublikasi(page) {
      currentPage = page;
      const container = document.getElementById('publicationsContainer');
      if (!container) return;

      const start = (currentPage - 1) * limit;
      const end = start + limit;
      const currentItems = filteredPubData.slice(start, end);

      if (currentItems.length === 0) {
        container.innerHTML = `<div class="col-12 text-center py-4"><p>Tidak ada publikasi yang cocok dengan kriteria.</p></div>`;
      } else {
        container.innerHTML = currentItems.map(item => `
                <div class="col-lg-4 col-md-6 mb-4">
                    <div class="publication-item minimal">
                        <div class="down-content">
                            <div class="mb-2">
                                <span class="badge bg-primary" style="font-size:10px">${item.nama_kategori || 'N/A'}</span>
                                <span class="badge bg-info text-dark" style="font-size:10px">${item.nama_fokus || 'N/A'}</span>
                            </div>
                            <h4>${item.judul}</h4>
                            <p><strong>Tahun: ${item.tahun || 'N/A'}</strong></p>
                            <div class="main-blue-button mt-3">
                                <a href="${item.external_link || '#'}" target="_blank">Detail Publikasi</a>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
      }

      renderPubPagination();
    }

    function renderPubPagination() {
      const paginContainer = document.getElementById('paginationContainer');
      if (!paginContainer) return;

      const totalPages = Math.ceil(filteredPubData.length / limit);

      if (totalPages <= 1) {
        paginContainer.innerHTML = '';
        return;
      }

      // Tampilan pagination
      paginContainer.innerHTML = `
            <button class="nav-btn pub-nav-btn" data-action="prev" ${currentPage === 1 ? 'disabled' : ''}>
                <i class="fa fa-angle-left"></i> Previous
            </button>
            <div class="main-blue-button all-list-button">
                <span style="color:white">Halaman ${currentPage} / ${totalPages}</span>
            </div>
            <button class="nav-btn pub-nav-btn" data-action="next" ${currentPage === totalPages ? 'disabled' : ''}>
                Next <i class="fa fa-angle-right"></i>
            </button>
        `;
    }

    // -----------------------------------------------------------------------------------
    // --- FUNGSI KUNCI GLOBAL EVENT DELEGATION (Filtering & Pagination) ---
    // -----------------------------------------------------------------------------------

    document.addEventListener('click', function (e) {
      // Mencari elemen <a> terdekat dengan class .dropdown-item (untuk filter)
      const item = e.target.closest('.dropdown-item');

      // --- 1. Logic Filtering ---
      if (item && item.closest('.filter-dropdown')) {
        e.preventDefault();

        const listEl = item.closest('.dropdown-menu');
        const containerEl = item.closest('.filter-dropdown');
        const btnEl = containerEl.querySelector('.filter-btn');

        const filterKey = item.dataset.filterKey; // 'tahun', 'fokus', 'kategori'
        const filterValue = item.dataset.value;

        if (!filterKey) return;

        // Visual toggle: hapus 'active' dari semua, tambahkan ke yang diklik
        listEl.querySelectorAll('.dropdown-item').forEach(i => i.classList.remove('active'));
        item.classList.add('active');

        // Set button text
        const originalLabel = btnEl.dataset.originalLabel || btnEl.innerText;
        btnEl.innerText = filterValue === 'all' ? originalLabel : filterValue;

        // Update Filter State
        activeFilters[filterKey] = filterValue;

        applyFilters(); // Jalankan Filter
        return;
      }

      // --- 2. Logic Pagination ---
      if (e.target.closest('.pub-nav-btn')) {
        e.preventDefault();
        const btn = e.target.closest('.pub-nav-btn');
        if (btn.disabled) return;

        const action = btn.dataset.action;
        const totalPages = Math.ceil(filteredPubData.length / limit);
        let newPage = currentPage;

        if (action === 'prev' && currentPage > 1) {
          newPage = currentPage - 1;
        } else if (action === 'next' && currentPage < totalPages) {
          newPage = currentPage + 1;
        } else {
          return;
        }

        renderPublikasi(newPage);
        const pubSection = document.getElementById('publications');
        // Gulir ke atas halaman publikasi setelah pindah halaman
        if (pubSection) pubSection.scrollIntoView({ behavior: 'smooth' });
      }
    });

    // ==========================================================
    // 3. BAGIAN DOSEN (Tidak Diubah)
    // ==========================================================
    async function fetchDosen() {
      const container = document.getElementById('dosen-list-flex');
      const loadingDosen = document.getElementById('loading-message'); // Asumsi ID ini ada

      if (!container) return;
      if (loadingDosen) loadingDosen.textContent = 'Memuat data dosen...';

      try {
        const response = await fetch(DOSEN_API_URL);
        const res = await response.json();

        if ((res.success || res.status === 'success') && Array.isArray(res.data)) {
          if (loadingDosen) loadingDosen.style.display = 'none';

          container.innerHTML = res.data.map(d => {
            // SCRIPT BARU (Menangani Link Eksternal ATAU File Lokal untuk list)
            // index.html - di dalam fetchDosen()
            // index.html - di dalam res.data.map(d => { ...

            let foto = DEFAULT_FOTO;

            if (d.foto_path && d.foto_path !== 'null') {
              // 1. Cek Link Eksternal (Dr. Rakhmat)
              if (d.foto_path.startsWith('http')) {
                foto = d.foto_path;
              } else {
                // 2. Jika Path Lokal (berdasarkan path yang benar di dosen.html)

                let pathLokal = d.foto_path;

                // Hapus 2 level "../" yang berlebihan di depan path.
                // Ini diasumsikan sebagai "offset" antara lokasi admin dan public.

                // Cari dan ganti 2 tingkat ../ pertama dengan string kosong
                pathLokal = pathLokal.replace('../', '');
                pathLokal = pathLokal.replace('../', '');

                // Tambahkan path yang benar dari folder public/ (yaitu 1 tingkat ../)
                foto = '../' + pathLokal;
              }
            }

            return `
                        <div class="member-card">
        <img src="${foto}" alt="${d.nama}" onerror="this.src='${DEFAULT_FOTO}'" style="object-fit: cover;">
                            <h5>${d.nama}</h5>
                            <span>${d.jabatan || 'Dosen'}</span>
                            <p>${d.nidn ? `NIDN: ${d.nidn}` : ''}</p>
                            <div class="main-blue-button">
                                <a href="detail_dosen.html?nidn=${d.nidn}">Info Detail</a>
                            </div>
                        </div>`;
          }).join('');
        }
      } catch (error) {
        console.error('Error Dosen:', error);
      }
    };


    // ==========================================================
    // 4. EKSEKUSI
    // ==========================================================
    document.addEventListener('DOMContentLoaded', () => {
      initPublikasi(); // Memulai Publikasi dengan filter dan pagination
      fetchDosen(); // Memulai Dosen
    });
  </script>
</body>

</html>